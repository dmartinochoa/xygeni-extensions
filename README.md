
<div align="center">
  <h1>Xygeni-Extensions</h1>
  <img src="img/xygeni.logo.png" alt="xygeni logo" width="250"/><br/>
  <i>End to End Software Supply Chain Security</i>
</div>

---

[![documentation](https://img.shields.io/badge/documentation-blue.svg)](https://docs.xygeni.io/)
[![xygeni.io](https://img.shields.io/badge/website-blue.svg)](https://xygeni.io/)
[![Project license](https://img.shields.io/github/license/xygeni/xygeni-extensions?style=flat-square)](LICENSE.md)

<details open="open">
<summary>Table of Contents</summary>

- [Overview](#overview)
- [How-To...](#how-to)
  - [Create a custom detector](#create-a-custom-detector) 
  - [Create a guardrail or workflow action](#create-a-guardrail-or-workflow-action)
  - [Create a report loader for a third-party tool](#create-a-report-loader-for-a-third-party-tool)
  - [Create an activity sensor for a software system](#create-an-activity-sensor-for-a-software-system)
- [Contributing](#contributing)

</details>

# Overview 

This project aims at extending the Xygeni platform for End to End Software Supply Chain Security. 

This repository help partners and end-users to share their own extensions and to request for new ones, that could be added to the platform or even provided here for the community.

The repository contains documentation and examples for Xygeni extensions, including:

- custom detectors,
- activity sensors,
- third-party report ingest, 
- guardrail and workflow actions.

# How to...

The following sections document how to add a custom component to the Xygeni platform, in a way that it could be shared with other users.

## Create a custom detector

A detector is a piece of logic that detects an issue in the scanned system like source code, a source code repository or a container image, a CI/CD system or another software tool. A detector has an implementation class and a YAML file configuring the detector and providing documentation for the issues created by the detector.

Read [Developing Custom Detectors](https://docs.xygeni.io/xydocs/developers/custom_detectors.html) for full documentation.

## Create a guardrail or workflow action

TBD

## Create a report loader for a third-party tool

Xygeni prioritization and response can be also used with security findings reported by third-party security tools (namely external scanners), both open-source and commercial. The scanner provides a report-upload command for uploading the structured reports generated by third-party security tools, in areas like Static Application Security Testing (SAST), Software Composition Analysis (SCA), or Secret Leaks / IaC Flaws Detection.

Imagine that your organization selected tool X for SAST. In your CI/CD pipelines you may have a step where the SAST tool is launched to uncover vulnerabilities in your source code or configurations. The output of the tool could be ingested by Xygeni to normalize the findings, and then use the findings for prioritization and remediation. The workflow can operate both on findings reported by Xygeni scans or by your third-party tool of choice, at least when its output format is supported.

The kind of security tools supported are:

* Static vulnerability scanners (SAST).
* Scanners for vulnerabilities in dependencies, also known as Software Composition Analysis (SCA).
* Secret leaks scanners.
* Infrastructure-as-Code flaws scanners.

> [!NOTE] 
> Support for other kind of tools, like API Security or Cloud Security Posture Management (CSPM), might be added in the future.

The `report-upload` framework is available with the scanner so new converters for unsupported formats could be added. This framework is the one which Xygeni uses for the provided converters.

<img src="img/report_upload_framework.png" width="70%" alt="report upload framework" style="display:block;margin-left:auto;margin-right:auto" />

To know the list of external scanners and formats supported, please go to the [external scanners supported](https://docs.xygeni.io/xydocs/integrations/external_scanners/external_scanners.html). 

For full details on how to upload the results from a third-party scanner using the xygeni `report-upload` command, read the [report-upload reference](https://docs.xygeni.io/xydocs/scanner/xygeni_scanner.html#_report_upload).

Adding support for a new external tool report requires:

1. To implement a _report loader_ for deserializing the external report into an object that could be transformed into the Xygeni standard model for the kind of tool.
2. To implement a _converter_ that translates the object returned by the loader into a standard model object that could be loaded by Xygeni. The transformed object will be serialized to JSON automatically for uploading to Xygeni.
3. Register the new format in the `xygeni.custom.report-upload.yml` so it could recognized by the `report-upload` command. 

See [Defining Custom Report Converters](https://docs.xygeni.io/xydocs/developers/custom_report_converters.html#_the_report_converters_framework) for further information on how to setup your development environment, how to implement the loader and converter classes and register the new format, and how to test the conversion.

## Create an activity sensor for a software system

TBD

# Contributing

First off, thanks for taking the time to contribute! Your efforts will help other xygeni users to get more value from the platform. We appreciate your contributions.

See [CONTRIBUTING](CONTRIBUTING.md) for further details about how to create an issue or a pull request for a bugfix or a new feature. 

# License

Please note that any contributions to Xygeni-Extensions (this project) are open-source under the terms of the Apache 2.0 license. 
See [LICENSE](LICENSE.md) for full details.